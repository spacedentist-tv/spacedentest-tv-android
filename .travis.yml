language: android
jdk:
  - oraclejdk8
android:
  components:
  - tools
  - platform-tools
  - tools
  - build-tools-25.0.0
  - android-25
  - extra-google-m2repository
  - extra-android-m2repository
before_cache:
  - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
  - rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
  - $HOME/.gradle/caches/
  - $HOME/.gradle/wrapper/
  - $HOME/.ivy2
  - $HOME/.m2
script:
- ./gradlew clean lintProdRelease testProdReleaseUnitTest assembleProdRelease
deploy:
  provider: releases
  skip_cleanup: true
  api_key:
    secure: KWBNMR7GfX0A5FxU9UPCku5oUjzz7SzfLgNwUcabN2OkOwFfLWwMHdT3fAVyIB0npRVANzGs6tQte5EUW1hv/vdmd0lCyn3pEsz6IVf8unMDlMMw5jnjoS1eR1km6YTDqzVf7Br4K8bFc+ACQNhslFrHAIPR0V3uRGYZXs4Vnw8=
  file: app/build/outputs/apk/app-prod-release-$TRAVIS_TAG.$TRAVIS_BUILD_NUMBER.apk
  on:
    repo: spacedentist-tv/spacedentist-tv-android
    all_branches: true
    tags: true
    condition: "$TRAVIS_TAG =~ ^[0-9]+\\.[0-9]+\\.[0-9]+$"
env:
  global:
  - secure: Nxrw4qcAT3WiM+KLn7plVP69GQt0JOcgqMfhBsGfIat1+GvMXdFBgwJA+oa8G8UKPix2flrEChTjDodYBOnfJGxkqDymgV322zWEyv6ufBGvsozw0dyO+Vrxub+bc/yb2EI0HaehGL3HCL7Ine3/KXRO43ugfonbuzK1SsGhl9Q=
  - secure: Jyznd6yL8u+K8YsxR2ar/+r/xE+oYhUF8JbBU7Z53DDJrTJkjm0lPpfaf/gYpPo3L3QMfv+RMJOJvWkuIr92UMsnI72N9K/Nh2bc3DGZmzIhvDJ8QuidFMi3GJy5vKWwRMDel2uJD6POxFwmsl5MuXriy94+xMjadAp5k1LqVNA=
before_install:
- openssl aes-256-cbc -K $encrypted_a46826f24119_key -iv $encrypted_a46826f24119_iv
  -in releasekey.jks.enc -out releasekey.jks -d
